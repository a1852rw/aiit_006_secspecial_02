# 情報セキュリティ特別講義2 延長戦 STの作成
## 演習の概要
- 編成：個人
- 作業内容：すでに作成したSTを適切な内容に修正する

## タイトル
- 紅電ICカード・セキュリティターゲット
- バージョン1.0
- AIIT株式会社

## 目次
- STの詳細は下記の通り
- 1.ST概説
  - 1.1 ST参照
    - ST名称
    - STバージョン
    - 発行日
    - 作成者
  - 1.2 TOE参照
    - TOE名称
    - TOEバージョン
  - 1.3 TOE概要
  - 1.4 TOE記述
- 2.適合主張
  - 2.1 CC適合主張
  - 2.2 PP主張
  - 2.3 パッケージ主張
  - 2.4 適合根拠
- 第3章：セキュリティ課題定義
  - 3.1 脅威
  - 3.2 組織のセキュリティ方針
  - 3.3 前提条件
- 第4章：セキュリティ対策方針
  - 4.1 TOEのセキュリティ対策方針
  - 4.2 運用環境のセキュリティ対策方針
  - 4.3 セキュリティ対策方針実施根拠
- 第5章 拡張コンポーネント定義
  - 5.1 拡張コンポーネント定義
- 第6章 TOE セキュリティ要件
  - 6.1 TOE セキュリティ要件
    - 6.1.1 TOE セキュリティ機能要件
    - 6.1.2 TOE セキュリティ保証要件
  - 6.2 IT 環境に対するセキュリティ要件
  - 6.3 セキュリティ要件根拠
    - 6.3.1 セキュリティ機能要件根拠
    - 6.3.2 セキュリティ機能要件依存性
    - 6.3.3 セキュリティ保証要件根拠
- 第7章 TOE要約仕様
  - 7.1 TOEセキュリティ機能
  - 7.2 保証手段
  - 7.3 TOE要約仕様根拠

### 1.ST概説
この章では、ST参照、TOE参照、TOE概要、TOE記述について記述する。

### 1.1 ST参照
- ST名称：紅電ICカード セキュリティターゲット
- STバージョン：1.0
- 発行日：2019年2月8日
- 作成者：AIIT株式会社

### 1.2 TOE参照
- TOE名称：紅電ICカード
- TOEバージョン：1.0

### 1.3 TOE概要
#### 1.3.1 TOEの主な用途とセキュリティ機能
TOEである紅電ICカード バージョン1.0は、一般企業で重要な情報(極秘情報など)を保管する施設や部屋への入退室を管理するために使用されるICカードである。
利用者はTOEをドアに備え付けられているカード読取装置にかざし、パスワードを入力することで入室することができる。
TOEは、以下のセキュリティ機能を備えている。
1. 利用者が登録されている利用者であることを識別する利用者識別と認証機能
1. カード読取装置/カード発行専用端末が正規のものであることを識別する識別機能と認証機能
1. 紅電ICカードに保存されているデータへのアクセス権を管理する認可機能(アクセスコントロール機能)
1. 紅電ICカードと周辺機器との通信を秘匿する暗号化機能
1. 紅電ICカードを分解しようとしたときに保存されているデータを消去する耐タンパ機能
1. 紅電ICカードへのサイドチャネル攻撃に対抗するノイズ発生機能

#### 1.3.2 TOE種別
TOEは、ICカード関連製品である。

#### 1.3.3 TOE以外のハードウェア/ソフトウェア
TOEは以下に示すTOE以外のIT機器に依存して動作する。  
- 紅電ICカード読取機 (型名：CR-0001)
- 紅電ICカード発行専用端末 (型名：CP-0001)


### 1.4 TOE記述
TOEである紅電ICカード バージョン1.0は、一般企業で重要な情報(極秘情報など)を保管する施設や部屋への入退室を管理するために使用されるICカードである。  
TOEには、入退室の制御に使用される個人情報を記録することができる。  
この個人情報の新規書き込みや変更は、カード発行端末(紅電ICカード発行機)からのみ行うことができる。  
カード利用者が紅電ICカードを用いて施設や部屋へ入退室を行う際は、ドアに取りつけられたカード読み取り機(紅電ICカード読取機)がカード内の個人情報を読み出すが、このときカード利用者が正しい暗証番号を入力しなければならない。  
  
TOEとカード発行端末との通信および、紅電ICカードと紅電カード読み取り機との通信はNFCにより行われる。  
紅電カード発行端末と紅電ICカード読取機との通信は無線LANにより行われる。紅電ICカード発行機には認証情報が暗号化され保存されており、認証サーバとして動作する。  
紅電ICカードをカード読み取り機にかざした際に紅電ICカード読み取り機と通信を行い紅電ICカードの認証を行う。  
紅電ICカード本体および、紅電ICカードに組み込まれているプログラムはこのSTの範囲に含まれる。紅電ICカード発行機や紅電ICカード読取機のセキュリティはこのSTの範囲ではない。  

#### 1.4.1 TOEの物理的範囲
TOEは、以下で構成されている。
- 紅電ICカード(ハードウェア および ソフトウェア)
- 紅電ICカードご利用の手引き 第1版
- 紅電ICカードご利用の手引き(サービス提供者向け) 第1版
- 下記の図(1.4TOE記述)内の青枠で囲まれた部分

![1.4TOEの物理的範囲](https://github.com/a1852rw/aiit_006_secspecial_02/blob/master/003_%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%97%E6%BC%94%E7%BF%92%E5%BB%B6%E9%95%B7%E6%88%A6/001_%E7%94%BB%E5%83%8F%E7%BD%AE%E3%81%8D%E5%A0%B4/1.4%E9%81%A9%E5%90%88%E4%BB%95%E6%A7%98_001.png)

#### 1.4.2 TOEの論理的範囲
TOEの論理的範囲について記述する。TOEはセキュリティ機能について以下のような特徴を持っている。  
- 識別/認証機能
  - TOEは個人情報の新規書き込み、改変、読み出し、暗証番号の変更をする前に利用者/通信先の装置の識別と認証を行う。  
- アクセスコントロール機能
  - TOEはあらかじめ定められたルールに従いTOE内に保存されたデータへのアクセスを制御する。
- データの暗号化機能
  - TOEは保存されているデータを暗号化し内容を秘匿する。
- 通信の暗号化機能
  - TOEは周辺機器との通信を暗号化し通信の内容を秘匿する。
- 耐タンパ機能
  - TOEを分解しようとすると回路が物理的に破壊され保存されているデータとプログラムが読取不可能になる。
  - ノイズ源を埋め込み電力消費量や電磁波、処理のタイミングをかく乱することによりサイドチャネル攻撃を防御する。

### 2.適合主張
この章では、CC適合主張、PP主張、パッケージ主張、適合根拠について記述する。

### 2.1 CC適合主張
本STは、以下の通りCC適合を主張する。  
情報技術セキュリティ評価のためのコモンクライテリア

パート１:概説と一般モデル 2012年9月 バージョン3.1 改訂第4版 翻訳第1.0版  
パート2：セキュリティ機能コンポーネント 2012年9月 バージョン3.1 改訂第4版 翻訳第1.0版  
パート3：セキュリティ保証コンポーネント 2012年9月 バージョン3.1 改訂第4版 翻訳第1.0版

CCパート2 適合  
CCパート3 適合  
  
  
### 2.2 PP主張
このSTが適合しているPPはない

### 2.3 パッケージ適合主張
本STは、以下の通りパッケージ適合を主張する。  
  
パッケージ：EAL4適合  
  
### 2.4 適合根拠
本STはPP適合を主張していないので、PP適合根拠はない。  


### 第3章 セキュリティ課題定義
本章では、脅威、組織のセキュリティ方針および前提条件について記述する。  

### 3.1 脅威
脅威を以下に示す。  

- 個人情報の不正な出力(T.Export)
  - 攻撃者が紅電ICカード内の個人情報を不正に出力を実施し紅電ICカード内の個人情報を取得する
- 不正な読取機の設置(T.Fake)
  - 攻撃者が非正規の紅電ICカード読取機を設置して紅電ICカードの情報を不正に出力を行い、紅電ICカード内の個人情報を取得する。
- 不正に取得したカードの利用(T.Use_Card)
  - 攻撃者が紅電ICカードを拾得または盗難により入手し、入手した紅電ICカードを使用して認証を突破する。
  - この攻撃は攻撃者が紅電ICカードを取得または盗難により不正に入手し、その紅電ICカードを紅電ICカード読取機にかざすことで機密エリアの認証を突破し機密情報にアクセスすることを目的とする。
- パスワードの漏洩(T.Password)
  - 利用者が他者にパスワードを漏洩する。
  - この脅威は利用者が入室時に紅電ICカード読取機に入力しているパスワードを他の利用者もしくは攻撃者を含む他者に自己の利用しているパスワードを漏洩することである。
- 通信データの漏洩(T.Communication)
  - 攻撃者が紅電ICカード/紅電ICカード読取機/紅電ICカード発行機の間で行われる通信を盗聴し個人情報を入手する。
  - 攻撃者が紅電ICカード/紅電ICカード読取機/紅電ICカード発行機の間で行われる通信から個人情報を入手することを目的としている。
- カードの分解(T.Disassembly)
  - 攻撃者が紅電ICカードを物理的に分解し内部に保存されている利用者の個人情報、暗号化鍵、紅電ICカード内部で行われている処理についての情報を取得する。
  - この攻撃は利用者の個人情報を直接取得するとともに、暗号化についての情報を取得し暗号化を解除することで紅電ICカードに保存されたデータや通信の秘匿を無効化することを目的としている。
- サイドチャネル攻撃(T.Sidechanel)
  - 攻撃者が紅電ICカードの暗号の処理時間や消費電力、漏洩する電磁波を測定し統計的な処理を施すことでTOEを分解することなく内部で行われている処理についての情報を所得する。
  - この攻撃は暗号化についての情報を取得し暗号化を解除することで紅電ICカードに保存されたデータや通信の秘匿を無効化することを目的としている。
- パスワードの総当たり攻撃(T.Brute_Force)
  - この攻撃は攻撃者がパスワード入力画面で文字列を網羅的に入力することにより認証を突破することを目的としている。
- 簡単なパスワードの設定(T.Easy_Password)
  - 利用者が初期設定のパスワードを利用する、もしくは認証が意味をなさないほど簡単な文字列をパスワードとして設定することである
- 不正なアクセス(T.Access)
  - 攻撃者がTOE内の個人情報に不にアクセスし、情報の不正な出力や改竄を行う。
  - この攻撃は攻撃者がカード発行専用端末以外の機器を使用し紅電ICカード内の個人情報の読み出しや処理を不正に行うことにより、紅電ICカードを不正に使用することを目的としている。

### 3.2 組織のセキュリティ方針
組織のセキュリティ方針を以下に示す。

- 暗号標準(P.Crypte_Std)
  - 暗号アルゴリズムはCRYPTREC暗号リストに記載されているものを使用しなければならない。
- 単純なパスワードの禁止(P.Easy_Password)
  - パスワードには単純な文字列や、容易に推測しうる文字列を指定してはならない。

### 3.3 前提条件  
TOE利用の前提条件を以下に示す。

- 共連れの防止(A.More_User)
  - 利用者が他の人間と一緒に入室することはできない。
- 停電(A.Power_Cuts)
  - 紅電ICカード読取機および紅電カード発行機には常に十分な電力が供給される
- 信頼できる管理者(A.Manage_Safe_Place)
  - 紅電ICカード発行専用端末に物理的にアクセスしうるのは管理者のみである。また、紅電ICカード発行機にログオンし、管理上の操作を行えるのは管理者のみである。
- ICカードの盗難の防止(A.Steal)
  - 攻撃者によって利用者に支給された紅電ICカードが盗み出されることはない。ICカードは「紅電ICカードご利用の手引き」に従い利用者が厳重に管理しているものとする。
- ICカードの紛失(A.Lost)
  - 利用者が支給された紅電ICカードを紛失することはない。紅電ICカードは「紅電ICカードご利用の手引き」に従い利用者が厳重に管理しているものとする。
- ICカードの貸し借り(A.Borrow)
  - 利用者が他の者に紅電ICカードを貸し出す。もしくは他の利用者から紅電ICカードを借りて利用することはない。紅電ICカードは「紅電ICカードご利用の手引き」に従い利用されており、利用者間での紅電ICカードの貸し借りは禁止されている。
  
### 第4章
本章では、TOEのセキュリティ対策方針、運用環境のセキュリティ対策方針及びセキュリティ対策方針根拠について記述する。  

### 4.1 TOEのセキュリティ対策方針
TOEのセキュリティ対策方針を以下に示す。 

- アクセス元の認証(OT.Authenticifation)
  - TOEへのアクセス時にはアクセス元端末を識別し真正性を確認する。アクセス元端末が真正なものと確認できない場合はアクセスを拒否する。
- パスワードによる認証(OT.Lost)
  - TOEの利用時にはパスワードによる認証を行い利用者を一意に識別し本人の確認を行う。
  - 認証に失敗した場合はデータの出力を拒否する。
- パスワード入力回数の制限(OT.Input)
  - パスワード入力回数に制限を設け、一定回数以上連続して誤ったパスワードを入力された場合は入力を拒否する。
- 単純なパスワードの禁止(OT.Easy_Password)
  - パスワードに単純な文字列が設定されようとした場合にそれを拒否する。
- ルート権限の禁止(OT.Access)
  - ルート権限によるTOEへのアクセスをシステム上で禁止し、利用者・管理者それぞれ専用の権限でのみアクセスを許可する。
- データ保存への暗号標準の採用(OT.Encryption)
  - 紅電ICカードに保存された利用者の個人情報CRYPTRECリストに記載されているアルゴリズムで暗号化しなければならない。
- 通信への暗号標準の採用(OT.Communication)
  - 紅電ICカード、紅電ICカード読取機、紅電ICカード発行機の通信はCRYPTERECリストに記載されているアルゴリズムで暗号化しなければならない。
- 物理的耐タンパ機能の搭載(OT.Disassembly)
  - 紅電ICカードを分解しようとすると回路が物理的に破壊されデータおよび処理の内容を推定できる情報が消去されなければならない。
- サイドチャネル攻撃に対する耐タンパ機能の搭載(OT.Sidechanel)
  - 紅電ICカードで行われる処理の内容を外部に対して隠蔽しなければならない。

### 4.2 運用環境のセキュリティ対策方針
運用環境のセキュリティ対策方針を以下に示す。  

- パスワードの管理(OE.Password)
  - 利用者がパスワードを秘密に保持できるようにその管理手続きを規定する。
- 利用者の教育(OE.Educate1)
  - 利用者が自己の認証情報と支給されたTOEの管理を徹底することするよう教育を行う。
- 管理者の教育(OE.Educate2)
  - 管理者が不適切なユーザ管理を行わないよう教育を行う。
- 電力の供給(OE.Power_Cut)
  - TOE利用環境には主電源の他に副電源が設置されており、停電が発生した際には自動的に副電源に切り替わる。
  - そのため電力の供給が途絶えることはない。
- マントラップの設置(OE.More_User)
  - 機密エリアの入り口にはICカード読取装置とともにマントラップ(一人ずつしか入れない)が設置されている。
- カード発行専用端末の安全な場所への設置(OE.Manage_Safe_Place)
  - カード発行専用端末は管理者のみが入室することのできる部屋に設置する。
  - また、カード発行専用端末にはログイン権限を設定し管理者以外は操作することができないようにする。


### 4.3 セキュリティ対策方針実施根拠
セキュリティ対策は、本章で規定した脅威に対抗するためのものである。あるいは、TOEの前提条件と組織のセキュリティ方針を実現するためのものである。  
セキュリティ対策方針と対抗する脅威および対応する組織のセキュリティ方針および前提条件の対応関係を示す。

![4.3セキュリティ対策方針実施根拠](https://github.com/a1852rw/aiit_006_secspecial_02/blob/master/003_グループ演習延長戦/001_画像置き場/4.3セキュリティ対策方針実施根拠.png)


## 第5章 拡張コンポーネント定義
### 5.1 拡張コンポーネント定義
本STは、CCパート2またはCCパート3のコンポーネントに基づかない要件を含んでいない。

## 第6章 TOE セキュリティ要件
### 6.1 TOE セキュリティ要件
本章では、セキュリティ機能要件、セキュリティ保証要件およびセキュリティ要件根拠について記述する。

#### 6.1.1. TOE セキュリティ機能要件
本章ではCCパート2で規定されている機能要件コンポーネントを直接使用する。  
  
![6.1.1TOEセキュリティ機能要件](https://github.com/a1852rw/aiit_006_secspecial_02/blob/master/003_グループ演習延長戦/001_画像置き場/6.1.1TOEセキュリティ機能要件-001.png)
![6.1.1TOEセキュリティ機能要件](https://github.com/a1852rw/aiit_006_secspecial_02/blob/master/003_グループ演習延長戦/001_画像置き場/6.1.1TOEセキュリティ機能要件-002.png)

#### 6.1.2. TOE セキュリティ保証要件
セキュリティ保証要件を記述する。  
本TOEの評価保障レベルはEAL4である。すべてのセキュリティ保証要件はCCパート3に規定されているセキュリティ保証コンポーネントを直接使用する。

![6.1.2TOEセキュリティ保証要件](https://github.com/a1852rw/aiit_006_secspecial_02/blob/master/003_グループ演習延長戦/001_画像置き場/6.1.2.TOEセキュリティ保証要件.png)


### 6.2 セキュリティ要件根拠
#### 6.2.1 セキュリティ機能要件根拠
各TOEセキュリティ対策方針は少なくとも1つのセキュリティ機能要件により実現される。  
以下の表でセキュリティ機能要件は少なくとも一つのセキュリティ対策方針に対応していることを示す。  

![6.2.1セキュリティ機能要件根拠](https://github.com/a1852rw/aiit_006_secspecial_02/blob/master/003_グループ演習延長戦/001_画像置き場/6.2.1セキュリティ機能要件根拠.png)


以下にセキュリティ機能要件が十分であることを説明する。

##### アクセス元の認証(OT.Authenticifation)
TOEは紅電ICカード発行機、紅電ICカード読取機との間で通信を行う際に、通信先の認証と識別を行う。  
非正規の紅電ICカード発行機、紅電ICカード読取機を検出した場合は通信をブロックする。この動作によりTOE内に保存された個人情報が攻撃者の手に渡ることを防ぐことができる。  
この動作は、「FIA_UAU.2」および「FIA_UID.2」を満足する。

##### パスワードによる認証(OT.Lost)
TOEは紅電ICカード発行機、紅電ICカード読取機との間で通信を行う際に、利用者の認証と識別を行う。この動作は「FIA_UAU.2」および「FIA_UID.2」を満足する。  
また、利用者の役割を識別し、指定した役割のみに必要な暗証番号の管理を制限する。この動作は「FMT_SMF.1」を満足する。  

##### パスワード入力回数の制限(OT.Input)
TOEはパスワードにより利用者の認証を行う。この際3回連続で認証に失敗した場合、その紅電ICカードによる認証を1時間ブロックする。  
この動作は「FIA_AFL.1」を満足する。  

##### 単純なパスワードの禁止(OT.Easy_Password)
TOEは6文字以上で連番もしくは同一でない数字をパスワードとして要求し、これが満たされない場合はパスワードの設定を拒否する。  
この動作は「FIA_SOS.1」を満足する。  

##### ルート権限の禁止(OT.Access)
##### データ保存への暗号標準の採用(OT.Encryption)
##### 通信への暗号標準の採用(OT.Communication)
##### 物理的耐タンパ機能の搭載(OT.Disassembly)
##### サイドチャネル攻撃に対する耐タンパ機能の搭載(OT.Sidechanel)

#### 6.2.2 セキュリティ機能要件依存性
以下の表でセキュリティ要件のコンポーネント依存性を示す。  

```txt
ここにはコンポーネント依存性を説明した表を挿入する
```

#### 6.2.3 セキュリティ保証要件根拠
セキュリティ保証要件根拠を以下に示す。  
  
本製品は紅電ICカードとパスワードをもって認証を行うことで重要区画への入退室を管理するシステムで、重要区画に保管されている情報へのアクセスを制限する商用製品である。  
EAL4はセキュリティ機能に対する完全なテストカバレージのほか、TOEが開発中または配布中に改竄が行われないという仕組みの確認が行われている。  
また、確認の範囲には当TOEを適切に利用するためのガイダンス情報も含んでいる。  
以上から商用製品の評価として妥当な選択であると言える。  


## 第7章 TOE要約仕様
### 7.1 TOEセキュリティ機能
本章では、TOEが提供するセキュリティ機能の要約仕様について述べる。

本TOEのセキュリティ機能は以下の5件

1. 利用者が登録されている利用者であることを識別する利用者識別と認証機能
1. 紅電ICカード読取装置/紅電ICカード発行機が正規のものであることを識別する識別機能と認証機能
1. 紅電ICカードに保存されているデータへのアクセス権を管理する認可機能(アクセスコントロール機能)
1. 紅電ICカードと周辺機器との通信を秘匿する暗号化機能
1. 紅電ICカードを分解しようとしたときに保存されているデータを消去する耐タンパ機能
1. 紅電ICカードへのサイドチャネル攻撃に対して処理を隠蔽する耐タンパ機能

それぞれについて、要約仕様を述べる。

#### 7.1.1 アクセス元の認証(OT.Authenticifation)
紅電ICカードは紅電ICカード読取機、紅電ICカード発行機と通信を行う際に、紅電ICカード読取機、紅電ICカード発行機の識別と認証を行う。  
正規のものではない紅電ICカード読取機、紅電ICカード発行専用端末を検出し通信をブロックする。この動作により紅電ICカード内に保存された個人情報が攻撃者の手に渡ることを防ぐことができる。  

#### 7.1.2 パスワードによる認証(OT.Lost)
TOEは紅電ICカードとパスワードによって利用者を識別し認証を行う。紅電ICカード読取機に紅電ICカードをかざした際に紅電ICカード読取機は紅電ICカードの情報を紅電ICカード発行機に問い合わせ識別と認証を行う。続いて紅電ICカード読取機は入力されたパスワードについて紅電ICカード発行機に問い合わせ認証う。パスワードが間違ってた場合は入室を拒否する。

#### 7.1.3 パスワード入力回数の制限(OT.Input)
#### 7.1.4 単純なパスワードの禁止(OT.Easy_Password)
#### 7.1.5 ルート権限の禁止(OT.Access)
紅電ICカードは紅電ICカード内部に保存されている個人情報への外部からのアクセスに対しアクセスコントロールを行う。  
外部からのアクセスには、利用者および管理者が紅電ICカード発行機/紅電ICカード読取機から行う正規のものと、攻撃者による非正規のものが存在する。  
正規のアクセスに対しては利用者、管理者それぞれにアクセス権が割り当てられその範囲内でのみ紅電ICカード内の個人情報にアクセスすることがでいる。  
攻撃者に対してはアクセス権が割り当てられておらずアクセスそのものをブロックする。  
この動作は「FDP_ACF.1」および「FMT_MSA.3」を満足する。  

#### 7.1.6 データ保存への暗号標準の採用(OT.Encryption)
紅電ICカードは、紅電ICカード内に保存されているカード利用者のデータに不正にアクセスしようとした際に、これを保護する。具体的には、チップ表面が空気に触れると記録内容が消滅するメモリチップを使用したり、信号を読み出す装置を取り付けると動作しなく回路を利用するなどして、不正な読み出しを行おうとする侵害シナリオにに自動的に対応する。これにより、「FPT_PHP.3.1 TSF」を満足する。  

#### 7.1.7 通信への暗号標準の採用(OT.Communication)
紅電ICカードは、周辺機器との通信を行う際に、通信内容を暗号化する。
周辺機器とは具体的には紅電ICカード発行機と紅電ICカードカード読取機であって、これら周辺機器との通信を暗号化することでFDP_ITT.1 基本内部転送保護を満足する。
カード利用者が紅電ICカードを用いて施設や部屋へ入退室を行う際には、ドアに取りつけられた紅電ICカード読取機が紅電ICカード内の個人情報を読み出す通信を行い、紅電ICカードカード読取機は読み出した個人情報を紅電ICカード発行機とやり取りする通信を行う。また紅電ICカードカード発行時には、紅電ICカード発行機と紅電ICカードとの間で通信が発生する。これらの個人情報を含む通信は、紅電ICカードと紅電ICカード読取機及び紅電ICカードと紅電ICカード発行機の間ではNFC（Near Field Communication）で行われる。また、紅電ICカード読取機とカード発行端末間の通信はWi-Fiで行われる。これらの通信を暗号化し、その通信内容を読み出すことができないようにすることで「FDP_ITT.1.1 TSF」を満足する。  

#### 7.1.8 物理的耐タンパ機能の搭載(OT.Disassembly)
#### 7.1.9 サイドチャネル攻撃に対する耐タンパ機能の搭載(OT.Sidechanel)
