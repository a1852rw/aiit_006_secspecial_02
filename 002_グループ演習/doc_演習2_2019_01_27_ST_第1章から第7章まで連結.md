# 情報セキュリティ特別講義2 演習2 STの作成
## 演習の概要
- 編成：グループ演習
- 作業内容：STの第1章~第2章を作成する

## ST作成演習のテーマなど
### STのテーマ
- TOE:ICカード
- EAL：レベル4
- これらのSTを作成しWORDで都度提出する
- 発表の際はパワーポイントにすることが望ましい(パワーポイントでなくてもよい)

### 補足説明
- TOEの名称はXXICカードシステムの形式で任意に指定する
- TOEの詳細については下記スライドに記載されている
  - 「情報セキュリティ特別講義2（第4回）.pdf」のP30~
  - 「情報セキュリティ特別講義2（第6回）.pdf」のP8～
- 演習は持ち越さず授業時間内に完了することが望ましい

## 目次
- STの詳細は下記の通り
- 1.ST概説
  - 1.1 ST参照
    - ST名称
    - STバージョン
    - 発行日
    - 作成者
  - 1.2 TOE参照
    - TOE名称
    - TOEバージョン
  - 1.3 TOE概要
  - 1.4 TOE記述
- 2.適合主張
  - 2.1 CC適合主張
  - 2.2 PP主張
  - 2.3 パッケージ主張
  - 2.4 適合根拠
- 第3章：セキュリティ課題定義
  - 3.1 脅威
  - 3.2 組織のセキュリティ方針
  - 3.3 前提条件
- 第4章：セキュリティ対策方針
  - 4.1 TOEのセキュリティ対策方針
  - 4.2 運用環境のセキュリティ対策方針
  - 4.3 セキュリティ対策方針実施根拠
- 第5章 拡張コンポーネント定義
  - 5.1 拡張コンポーネント定義
- 第6章 TOE セキュリティ要件
  - 6.1 TOE セキュリティ要件
    - 6.1.1 TOE セキュリティ機能要件
    - 6.1.2 TOE セキュリティ保証要件
  - 6.2 IT 環境に対するセキュリティ要件
  - 6.3 セキュリティ要件根拠
    - 6.3.1 セキュリティ機能要件根拠
    - 6.3.2 セキュリティ機能要件依存性
    - 6.3.3 セキュリティ保証要件根拠
- 第7章 TOE要約仕様
  - 7.1 TOEセキュリティ機能
  - 7.2 保証手段
  - 7.3 TOE要約仕様根拠

### 1.ST概説
この章では、ST参照、TOE参照、TOE概要、TOE記述について記述する。

### 1.1 ST参照
- ST名称：紅電ICカード セキュリティターゲット
- STバージョン：1.0
- 発行日：2018年12月1日
- 作成者：AIIT株式会社

### 1.2 TOE参照
- TOE名称：紅電ICカード
- TOEバージョン：1.0

### 1.3 TOE概要
#### 1.3.1 TOEの主な用途とセキュリティ機能
TOEである紅電ICカード バージョン1.0は、一般企業で重要な情報(極秘情報など)を保管する施設や部屋への入退室を管理するために使用されるICカードである。
利用者はTOEをドアに備え付けられているカード読取装置にかざし、パスワードを入力することで入室することができる。
TOEは、以下のセキュリティ機能を備えている。
1. 利用者が登録されている利用者であることを識別する利用者識別と認証機能
1. カード読取装置/カード発行専用端末が正規のものであることを識別する識別機能と認証機能
1. TOEに保存されているデータへのアクセス権を管理する認可機能(アクセスコントロール機能)
1. TOEと周辺機器との通信を秘匿する暗号化機能
1. TOEを分解しようとしたときに保存されているデータを消去する耐タンパ機能

#### 1.3.2 TOE種別
TOEは、ICカード関連製品である。

#### 1.3.3 TOE以外のハードウェア/ソフトウェア
TOEは以下に示すTOE以外のIT機器に依存して動作する。  
- 紅電ICカード読取機 (型名：CR-0001)
- 紅電ICカード発行専用端末 (型名：CP-0001)


### 1.4 TOE記述
TOEである紅電ICカード バージョン1.0は、一般企業で重要な情報(極秘情報など)を補完する施設や部屋への入退室を管理するために使用されるICカードである。  
TOEには、入退室の制御に使用される個人情報を記録することができる。  
この個人情報の新規書き込みや変更は、カード発行端末(紅電ICカード発行機)からのみ行うことができる。  
カード利用者がTOEを用いて施設や部屋へ入退室を行う際は、ドアに取りつけられたカード読み取り機(紅電ICカード読取機)がカード内の個人情報を読み出すが、このときカード利用者が正しい暗証番号を入力しなければならない。  

TOEとカード発行端末との通信および、TOEとカード読み取り機との通信はNFCにより行われる。  
カード発行端末とカード読み取り機との通信は無線LANにより行われる。カード発行端末には認証情報が暗号化され保存されており、TOEをカード読み取り機にかざした際にカード読み取り機と通信を行いTOEの認証を行う。
なお、カード発行端末やカード読取機のセキュリティはこのSTの範囲ではない。  

（１）TOEの物理的範囲
TOEは、以下で構成されている。
- 紅電ICカード
- 紅電ICカードご利用の手引き 第1版
- 紅電ICカードご利用の手引き(サービス提供者向け) 第1版
- 下記の図(1.4TOE記述)内の青枠で囲まれた部分

![1.4TOEの物理的範囲](https://github.com/a1852rw/aiit_006_secspecial_02/blob/master/002_%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%97%E6%BC%94%E7%BF%92/001_%E7%94%BB%E5%83%8F%E7%BD%AE%E3%81%8D%E5%A0%B4/1.4%E9%81%A9%E5%90%88%E4%BB%95%E6%A7%98_001.png)

### 2.適合主張
この章では、CC適合主張、PP主張、パッケージ主張、適合根拠について記述する。

### 2.1 CC適合主張
本STは、以下の通りCC適合を主張する。  
情報技術セキュリティ評価のためのコモンクライテリア

パート１:概説と一般モデル 2012年9月 バージョン3.1 改訂第4版 翻訳第1.0版  
パート2：セキュリティ機能コンポーネント 2012年9月 バージョン3.1 改訂第4版 翻訳第1.0版  
パート3：セキュリティ保証コンポーネント 2012年9月 バージョン3.1 改訂第4版 翻訳第1.0版

CCパート2 適合  
CCパート3 適合  
  
  
### 2.2 PP主張
このSTが適合しているPPはない

### 2.3 パッケージ適合主張
本STは、以下の通りパッケージ適合を主張する。  
  
パッケージ：EAL4適合  
  
### 2.4 適合根拠
本STはPP適合を主張していないので、PP適合根拠はない。  


### 第3章 セキュリティ課題定義
本章では、脅威、組織のセキュリティ方針および前提条件について記述する。  

### 3.1 脅威
脅威を以下に示す。  

- 個人情報の不正な出力(T.Export)
  - 攻撃者がICカード内の個人情報を不正に出力を実施しカード内の個人情報を取得する
- 不正な読取機の設置(T.Fake)
  - 攻撃者が非正規のカード読取機を設置してICカードの情報を不正に出力を行い、カード内の個人情報を取得する。
- 不正に取得したカードの利用(T.Use_Card)
  - 攻撃者がICカードを拾得または盗難により入手し、入手したICカードを使用して認証を突破する。
  - この攻撃は攻撃者がICカードを取得または盗難により不正に入手し、そのICカードをカード読取機にかざすことで機密エリアの認証を突破し機密情報にアクセスすることを目的とする。
- パスワードの漏洩(T.Password)
  - 利用者が他者にパスワードを漏洩する。
  - この脅威は利用者が入室時にカード読取機に入力しているパスワードを他の利用者もしくは攻撃者を含む他者に自己の利用しているパスワードを漏洩することである。
- 通信データの漏洩(T.Communication)
  - 攻撃者がICカード/ICカード読取機/カード発行専用端末の間で行われる通信を盗聴し個人情報を入手する。
  - 攻撃者がICカード/ICカード読取機/カード発行専用端末の間で行われる通信から個人情報を入手することを目的としている。

### 3.2 組織のセキュリティ方針
組織のセキュリティ方針はない。  

- 暗号標準(P.Crypte_Std)
  - 暗号アルゴリズムはCRYPTRECリストに記載されているものを使用しなければならない。

### 3.3 前提条件  
TOE利用の前提条件を以下に示す。

- 共連れ(A.More_User)
  - 利用者が他の人間と一緒に入室することはない。機密エリアの入り口にはマントラップが設置されており物理的に一人ずつしか入退室を行うことができない。
- ICカード読取機の破壊(A.Hard_Broken_Reader)
  - ICカード読取装置は破壊されない
- 停電(A.Power_Cuts)
  - ICカード読取機およびカード発行専用端末には常に十分な電力が供給される
- 信頼できる管理者(A.Manage_Safe_Place)
  - 紅電ICカード発行専用端末に物理的にアクセスしうるのは管理者のみである。また、紅電ICカード発行専用端末にログオンし、管理上の操作を行えるのは管理者のみである。
- ICカードの盗難の防止(A.Steal)
  - 攻撃者によって利用者に支給されたICカードが盗み出されることはない。ICカードは「紅電ICカードご利用の手引き」に従い利用者が厳重に管理しているものとする。
- ICカードの紛失(A.Lost)
  - 利用者が支給されたICカードを紛失することはない。ICカードは「紅電ICカードご利用の手引き」に従い利用者が厳重に管理しているものとする。
- ICカードの貸し借り(A.Borrow)
  - 利用者が他の者にICカードを貸し出す。もしくは他の利用者からICカードを借りて利用することはない。ICカードは「紅電ICカードご利用の手引き」に従い利用されており、利用者間でのICカードの貸し借りは禁止されている。
  
### 第4章
本章では、TOEのセキュリティ対策方針、運用環境のセキュリティ対策方針及びセキュリティ対策方針根拠について記述する。  

### 4.1 TOEのセキュリティ対策方針
TOEのセキュリティ対策方針を以下に示す。 

- アクセス元の認証(OT.Authenticifation)
  - TOEへのアクセス時にはアクセス元端末を識別し真正性を確認する。アクセス元端末が真正なものと確認できない場合はアクセスを拒否する。
- パスワードによる認証(OT.Lost)
  - TOEの利用時にはパスワードによる認証を行い利用者を一意に識別し本人の確認を行う。
  - 認証に失敗した場合は入室を拒否する。
- ルート権限の禁止(OT.Access)
  - ルート権限によるTOEへのアクセスをシステム上で禁止し、利用者・管理者それぞれ専用の権限でのみアクセスを許可する。
- データ保存への暗号標準の採用(OT.Encryption)
  - ICカードに保存された利用者の個人情報CRYPTRECリストに記載されているアルゴリズムで暗号化しなければならない。
- 通信への暗号標準の採用(OT.Communication)
  - 紅電ICカード、ICカード読取機、カード発行専用端末間の通信はCRYPTERECリストに記載されているアルゴリズムで暗号化しなければならない。


### 4.2 運用環境のセキュリティ対策方針
運用環境のセキュリティ対策方針を以下に示す。  

- パスワードの管理(OE.Password)
  - 利用者がパスワードを秘密に保持できるようにその管理手続きを規定する。
- 利用者の教育(OE.Educate1)
  - 利用者が自己の認証情報の管理を徹底することするよう教育を行う。
- 管理者の教育(OE.Educate2)
  - 管理者が不適切なユーザ管理を行わないよう教育を行う。
- 電力の供給(OE.Power_Stop)
  - TOE利用環境には主電源の他に副電源が設置されており、停電が発生した際には自動的に副電源に切り替わる。
  - そのため電力の供給が途絶えることはない。
- マントラップの設置(OE.More_User)
  - 機密エリアの入り口にはICカード読取装置とともにマントラップ(一人ずつしか入れない)
- カード発行専用端末の安全な場所への設置(OE.Manage_Safe_Place)
  - カード発行専用端末は管理者のみが入室することのできる部屋に設置する。
  - また、カード発行専用端末にはログイン権限を設定し管理者以外は操作することができないようにする。


### 4.3 セキュリティ対策方針実施根拠
セキュリティ対策は、本章で規定した脅威に対抗するためのものである。あるいは、TOEの前提条件と組織のセキュリティ方針を実現するためのものである。  
セキュリティ対策方針と対抗する脅威および対応する組織のセキュリティ方針および前提条件の対応関係を示す。

| |  T.Export  | T.Fake |  T.Use_Card  |  T.Password  |  T.Communication  |  P.Crypte_Std  |  A.More_User  |  A.Power_Cuts  |  A.Manage_Safe_Place  |  A.Steal  |  A.Lost  |  A.Borrow  |
|---|---|---|---|---|---|---|---|---|---|---|---|---|
|  OT.Authenticifation  |  OK  |  OK  |    |    |    |    |    |    |    |    |    |    |
|  OT.Lost  |    |    |    |    |    |    |    |    |    |    |  OK  |  OK  |
|  OT.Access  |    |    |    |    |    |    |    |    |  OK  |    |    |    |
|  OT.Encryption  |    |    |    |    |    |  OK  |    |    |    |    |    |    |
|  OT.Communication  |    |    |    |    |  OK  |  OK  |    |    |    |    |    |    |
|  OE.Password  |    |    |    |  OK  |    |    |    |    |    |  OK  |  OK  |  OK  |
|  OE.Educate1  |    |    |  OK  |    |    |    |    |    |    |  OK  |  OK  |  OK  |
|  OE.Educate2  |    |    |  OK  |    |    |    |    |    |    |    |    |    |
|  OE.Power_Cut  |    |    |    |    |    |    |    |  OK  |    |    |    |    |
|  OE.More_User  |    |    |    |    |    |    |  OK  |    |    |    |    |    |
| OE.Manage_Safe_Place  |    |    |    |    |    |    |    |    |  OK  |    |    |    |


## 第5章 拡張コンポーネント定義
### 5.1 拡張コンポーネント定義
本STは、CCパート2またはCCパート3のコンポーネントに基づかない要件を含んでいない。

## 第6章 TOE セキュリティ要件
### 6.1 TOE セキュリティ要件
本章では、セキュリティ機能要件、セキュリティ保証要件およびセキュリティ要件根拠について記述する。

#### 6.1.1. TOE セキュリティ機能要件
本章ではCCパート2で規定されている機能要件コンポーネントを直接使用する。  

##### FPT_PHP.3 － 物理的攻撃への抵抗
- 下位階層: なし
- 依存性: なし
  - FPT_PHP.3.1 TSFは、TSPが侵害されないよう自動的に対応することによって、[割付: TSF装置/エレメントのリスト]への[割付: 物理的な干渉のシナリオ]に抵抗しなければならない。
  -  [割付: TSF装置/エレメントのリスト ]: ICチップ
  -  [割付: 物理的な干渉のシナリオ]: IC配線パターンの露出、リバースエンジニアリング、物理的プロービング、物理的マニピュレーション、環境ストレス、及び消費電力の測定・解析

##### FMT_SMR.1 － セキュリティ役割
- 下位階層: なし
- 依存性: FIA_UID.1 識別のタイミング
  - FMT_SMR.1.1 TSFは、役割[割付: 許可された識別された役割]を維持しなければならない。
  -  [割付: 許可された識別された役割]: カード発行者

##### FMT_SMR.1.2 TSFは、利用者を役割に関連づけなければならない。

##### FIA_UAU.7 － 保護された認証フィードバック
- 下位階層: なし
- 依存性: FIA_UAU.1 認証のタイミング
  -  FIA_UAU.7.1 TSFは、認証を行っている間、[割付: フィードバックのリスト]だけを利用者に提供しなければならない。
  -  [割付: フィードバックのリスト]:認証結果の成否以外に認証に関わる情報を含まない応答メッセージ

##### FIA_UID.2 － アクション前の利用者識別
- 下位階層: FIA_UID.1
- 依存性: なし
  - FIA_UID.2.1 TSFは、その利用者を代行する他のTSF調停アクションを許可する前に、各利用者に自分自身を識別することを要求しなければならない。

##### FDP_ITT.1 基本内部転送保護
- 下位階層: なし
- 依存性: [FDP_ACC.1 サブセットアクセス制御、または FDP_IFC.1 サブセット情報フロー制御]
  - FDP_ITT.1.1 TSF は、利用者データが TOE の物理的に分離されたパート間を転送される場合、その[選択: 暴露、改変、使用不可]を防ぐための[割付: アクセス制御 SFP 及び/または情報フロー制御 SFP]を実施しなければならない。
  - [選択: 暴露、改変、使用不可]→改変
  - [割付: アクセス制御 SFP 及び/または情報フロー制御 SFP]→アクセス制御及び情報フロー制御

##### FDP_ACF.1 セキュリティ属性によるアクセス制御
- 下位階層: なし
- 依存性: FDP_ACC.1 サブセットアクセス制御
  - FMT_MSA.3 静的属性初期化
  - FDP_ACF.1.1 TSF は、以下の[割付: 示されたSFP 下において制御されるサブジェクトとオブジェクトのリスト、及び各々に対応する、SFP 関連セキュリティ属性、またはSFP 関連セキュリティ属性の名前付けされたグループ]に基づいて、オブジェクトに対して、[割付: アクセス制御SFP]を実施しなければならない。

##### FDP_ACF.1 セキュリティ属性によるアクセス制御
- 下位階層: なし
- 依存性: FDP_ACC.1 サブセットアクセス制御

##### FMT_MSA.3 静的属性初期化
- FDP_ACF.1.1 TSF は、以下の[割付: 示されたSFP 下において制御されるサブジェクトとオブジェクトのリスト、及び各々に対応する、SFP 関連セキュリティ属性、またはSFP 関連セキュリティ属性の名前付けされたグループ]に基づいて、オブジェクトに対して、[割付: アクセス制御SFP]を実施しなければならない。

##### FDP_ACC.1 サブセットアクセス制御
- 下位階層: なし
- 依存性: FDP_ACF.1 セキュリティ属性によるアクセス制御
  - TSFは、[割付: サブジェクト、オブジェクト、及びSFPで扱われるサブジェクトとオブジェクト間の操作のリスト]に対して[割付: アクセス制御SFP]を実施しなければならない。

#### 6.1.2. TOE セキュリティ保証要件
セキュリティ保証要件を記述する。  
本TOEの評価保障レベルはEAL4である。すべてのセキュリティ保証要件はCCパート3に規定されているセキュリティ保証コンポーネントを直接使用する。

|  保証クラス  |  保証コンポーネント  | 
|---|---|
| ADV:開発  |  ADV_ARC  | 
|^|  ADC_FSP  |
|^|  ADC_IMP  |
|^|  ADC_TDS  |
| AGD:ガイダンス文書  |  AGD_OPE  |
|^|  AGD_PRE  | 
| ALC:ライフサイクルサポート  |  ALC_CMC  |
|^|  ALC_CMS  |
|^|  ALC_DEL  |
|^|  ALC_DVS  |
|^|  ALC_LCD  |
|^|  ADC_TAT  |
| ASE:セキュリティターゲット評価  |  ASE_CCL  |
|^|  ASE_ECD  |
|^|  ASE_INT  |
|^|  ASE_OBJ  |
|^|  ASE_REQ  |
|^|  ASE_SPD  |
|^|  ASE_TSS  | 
| ATE:テスト  |  ATE_COV  |
|^|  ATE_TPT  |
|^|  ATE_FUN  |
|^|  ATE_IND  | 
| 脆弱性評定:AVA  |  AVA_VAN  | 


### 6.2 環境に対するセキュリティ要件

### 6.3 セキュリティ要件根拠
#### 6.3.1 セキュリティ機能要件根拠
'''txt
セキュリティ機能要件とTOEセキュリティ対策方針の関係を表に示す。  
この表で示す通り、
「表にするかどうかはのちほど要検討」
'''
各TOEセキュリティ対策方針は少なくとも1つのセキュリティ機能要件により実現される。  
また、セキュリティ機能要件は少なくとも一つのセキュリティ対策方針に対応している。  
  
次に、TOEセキュリティ対策方針が、セキュリティ機能要件により実現できることを説明する。

#### 6.3.2 セキュリティ機能要件依存性
セキュリティ要件のコンポーネント依存性を以下に示す。  
 　
#### 6.3.3 セキュリティ保証要件根拠
セキュリティ保証要件根拠を以下に示す。  
  
本製品は紅電ICカードとパスワードをもって認証を行うことで重要区画への入退室を管理するシステムで、重要区画に保管されている情報へのアクセスを制限する商用製品である。  
EAL4はセキュリティ機能に対する完全なテストカバレージのほか、TOEが開発中または配布中に改竄が行われないという仕組みの確認が行われている。  
また、確認の範囲には当TOEを適切に利用するためのガイダンス情報も含んでいる。  
以上から商用製品の評価として妥当な選択であると言える。  


## 第7章 TOE要約仕様
### 7.1 TOEセキュリティ機能
本章では、TOEが提供するセキュリティ機能の要約仕様について述べる。

本TOEのセキュリティ機能は以下の5件

1. 利用者が登録されている利用者であることを識別する利用者識別と認証機能
1. カード読取装置/カード発行専用端末が正規のものであることを識別する識別機能と認証機能
1. TOEに保存されているデータへのアクセス権を管理する認可機能(アクセスコントロール機能)
1. TOEと周辺機器との通信を秘匿する暗号化機能
1. TOEを分解しようとしたときに保存されているデータを消去する耐タンパ機能

それぞれについて、要約仕様を述べる。

#### 7.1.1 利用者の識別と認証機能
TOEはICカードによって利用者の識別し認証を行う

#### 7.1.2 周辺機器の識別と認証機能(OT.Authenticifation)
TOEはカード読取機、ICカード発行専用端末と通信を行う際に、カード読取機、ICカード発行専用端末の識別と認証を行う。  
正規のものではないカード読取機、ICカード発行専用端末を検出し通信をブロックする。この動作によりTOE内に保存された個人情報が攻撃者の手に渡ることを防グことができる。
この動作は「FDP_ACF.1」および「FDP_ACF.1」を満足する。

#### 7.1.3 カードへのアクセスコントロール機能
TOEはTOE内部に保存されている個人情報への外部からのアクセスに対しアクセスコントロールを行う。  
外部からのアクセスには、利用者および管理者がICカード発行専用端末/カード読取機から行う正規のものと、攻撃者による非正規のものが存在する。  
正規のアクセスに対しては利用者、管理者それぞれにアクセス権が割り当てられその範囲内でのみTOE内の個人情報にアクセスすることがでいる。  
攻撃者に対してはアクセス権が割り当てられておらずアクセスそのものをブロックする。  
この動作は「FDP_ACF.1」および「FMT_MSA.3」を満足する。

#### 7.1.4 TOEと周辺機器との通信を暗号化する機能
TOEは、周辺機器との通信を行う際に、通信内容を暗号化する。
周辺機器とは具体的にはカード発行端末とカード読取機であって、これら周辺機器との通信を暗号化することでFDP_ITT.1 基本内部転送保護を満足する。
カード発行時にはカード発行端末からカード利用者のデータを含む通信が発生する。また、カード利用者がTOEを用いて施設や部屋へ入退室を行う際には、ドアに取りつけられたカード読取機がTOE内の個人情報を読み出し、この個人情報を含む通信が発生するが。これらカード発行端末やカード読取機が行う通信は暗号化されており、これを読み出すこともできないため、一部を改変することもできず、「FDP_ITT.1.1 TSF」を満足する。

#### 7.1.5 TOEを分解しようとしたときに保存されているデータを消去する機能
TOEは、TOEに保存されているカード利用者のデータに不正にアクセスしようとした際に、これを保護する。具体的には、チップ表面が空気に触れると記録内容が消滅するメモリチップを使用したり、信号を読み出す装置を取り付けると動作しなく回路を利用するなどして、不正な読み出しを行おうとする侵害シナリオにに自動的に対応する。これにより、「FPT_PHP.3.1 TSF」を満足する。
